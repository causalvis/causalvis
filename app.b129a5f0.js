(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{237:function(e,t,a){e.exports=a(354)},354:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(32),o=a(95),i=a(195),s=a(181),c=a(154),d=a(418),u=a(416),m=a(425),h=a(196),f=a(423);const g=e=>{let{value:t=[],color:a="black",isAdded:n=!1,treatment:l,outcome:o,addAttribute:i,deleteAttribute:s,changeTreatment:c,changeOutcome:d,handleAddTag:u}=e;const g={grey:{rgb:"rgb(158, 158, 158)",rgba:"rgba(158, 158, 158, 0.05)"},treatment:{rgb:"rgb(78, 121, 167)",rgba:"rgba(78, 121, 167, 0.05)"},outcome:{rgb:"rgb(242, 142, 44)",rgba:"rgba(242, 142, 44, 0.05)"},black:{rgb:"rgb(0, 0, 0)",rgba:"rgba(0, 0, 0, 0.05)"}},[x,p]=r.a.useState(!1),[y,k]=r.a.useState(null);function E(){k(null),p(!1)}const b={width:"100%",marginBottom:"5px",color:g[a].rgb,borderColor:g[a].rgb,"&:hover":{borderColor:g[a].rgb,backgroundColor:g[a].rgba}};return r.a.createElement("div",null,r.a.createElement(m.a,{sx:b,onClick:()=>i(t),onContextMenu:e=>function(e){e.preventDefault(),n&&(p(!x),k({left:e.clientX+2,top:e.clientY-6}))}(e),variant:"outlined"},r.a.createElement("a",{title:"click to add"},t)),r.a.createElement(h.a,{id:"basic-menu",anchorReference:"anchorPosition",anchorPosition:y,style:{},open:x,onClose:E,MenuListProps:{"aria-labelledby":"basic-button"}},r.a.createElement(f.a,{onClick:function(){l===t?(c(""),E()):o===t?(c(t),d(""),E()):(c(t),E())},selected:t===l},"Set as Treatment"),r.a.createElement(f.a,{onClick:function(){o===t?(d(""),E()):l===t?(d(t),c(""),E()):(d(t),E())},selected:t===o},"Set as Outcome"),r.a.createElement(f.a,{onClick:function(){u(t),E()}},"Edit Tags"),r.a.createElement(f.a,{onClick:function(){s(t),E()}},"Delete from Graph")))};var x=a(183),p=a.n(x),y=r.a.createElement(p.a,null),k=r.a.createElement("a",{title:"click to add"},"Add Node");const E=e=>{let{attributes:t=[],added:a=[],treatment:n,outcome:l,addAttribute:o,deleteAttribute:i,changeTreatment:s,changeOutcome:c,handleAddTag:d,handleNodeOpen:u}=e;function h(e){return n===e?"treatment":l===e?"outcome":a.indexOf(e)>=0?"black":"grey"}return r.a.createElement("div",null,r.a.createElement(m.a,{style:{width:"100%",marginBottom:"5px",width:"150px"},startIcon:y,variant:"contained",onClick:()=>u()},k),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"150px",marginRight:"20px",height:"500px",overflow:"scroll"}},t.map((e,t)=>r.a.createElement(g,{key:t,value:e,isAdded:a.indexOf(e)>=0,color:h(e),treatment:n,outcome:l,addAttribute:o,deleteAttribute:i,changeTreatment:s,changeOutcome:c,handleAddTag:d}))))};var b=a(27),v=a(429),C=a(185),S=a.n(C),w=r.a.createElement(S.a,null),O=r.a.createElement("g",null,r.a.createElement("g",{id:"links"}),r.a.createElement("g",{id:"nodes"}),r.a.createElement("g",{id:"nodeNames"})),M=r.a.createElement("g",{id:"legend"});const A=e=>{let{layout:t={height:500,width:1e3,margin:60},nodelinks:a={},mode:l="default",treatment:o="",outcome:i="",mediators:s=[],colliders:c=[],confounds:d=[],prognostics:u=[],search:m,updateNodePos:g,deleteAttribute:x,changeTreatment:p,changeOutcome:y,updateLinks:k,deleteLinks:E,_svg:C}=e;const[S,A]=r.a.useState(!1),[N,I]=r.a.useState(null),[T,j]=r.a.useState(null),[P,J]=r.a.useState([]),[L,B]=r.a.useState({treatment:"#4e79a7",outcome:"#f28e2c",confounds:"#e15759",colliders:"#76b7b2",mediators:"#59a14f",prognostics:"#b07AA1"});function D(){I(null),j(null),A(!1)}function R(e){return!!m&&(m===e.name||!!(m.startsWith("tag:")&&e.tags&&e.tags.indexOf(m.slice(4))>=0))}Object(n.useEffect)(()=>{m?K.filter(e=>R(e)).attr("stroke-width","3px"):K.attr("stroke-width","1px")},[m]),Object(n.useEffect)(()=>{for(let e of s)K.filter(t=>t.name===e).attr("stroke",L.mediators),q.filter(t=>t.name===e).attr("fill",L.mediators);for(let e of c)K.filter(t=>t.name===e).attr("stroke",L.colliders),q.filter(t=>t.name===e).attr("fill",L.colliders);for(let e of d)K.filter(t=>t.name===e).attr("stroke",L.confounds),q.filter(t=>t.name===e).attr("fill",L.confounds)},[s,c,d]);const G=Object(n.useRef)("svgDAG");let z=[],_=b.b(G.current),H=_.select("g");const $=b.c().extent([[0,0],[t.width,t.height]]).scaleExtent([.1,8]).on("zoom",(function(e){let{transform:t}=e;H.attr("transform",t)}));function F(e,t,a){let n;return n=e<0&&t<0?2*Math.PI-a:e<0&&t>0?Math.PI+a:e>0&&t>0?Math.PI-a:0===e&&t<0?0:0===e&&t>0?Math.PI:e>0&&0===t?Math.PI/2:e<0&&0===t?Math.PI/2*3:a,n}_.call($);var W=H.select("#links").selectAll(".arrowleft").data(a.links).join("line").attr("class","arrowleft").attr("x1",e=>(e.target.x-e.source.x)/2+e.source.x).attr("y1",e=>(e.target.y-e.source.y)/2+e.source.y).attr("x2",e=>{let t=e.target.y-e.source.y,a=e.target.x-e.source.x,n=F(t,a,Math.atan(Math.abs(t/a)));return(e.target.x-e.source.x)/2+e.source.x+10*Math.cos(n+Math.PI/5)}).attr("y2",e=>{let t=e.target.y-e.source.y,a=e.target.x-e.source.x,n=F(t,a,Math.atan(Math.abs(t/a)));return(e.target.y-e.source.y)/2+e.source.y-10*Math.sin(n+Math.PI/5)}).attr("stroke","black").attr("stroke-width",1),V=H.select("#links").selectAll(".arrowright").data(a.links).join("line").attr("class","arrowright").attr("x1",e=>(e.target.x-e.source.x)/2+e.source.x).attr("y1",e=>(e.target.y-e.source.y)/2+e.source.y).attr("x2",e=>{let t=e.target.y-e.source.y,a=e.target.x-e.source.x,n=F(t,a,Math.atan(Math.abs(t/a)));return(e.target.x-e.source.x)/2+e.source.x+10*Math.cos(n-Math.PI/5)}).attr("y2",e=>{let t=e.target.y-e.source.y,a=e.target.x-e.source.x,n=F(t,a,Math.atan(Math.abs(t/a)));return(e.target.y-e.source.y)/2+e.source.y-10*Math.sin(n-Math.PI/5)}).attr("stroke","black").attr("stroke-width",1);function Y(e){return e.name===o?L.treatment:e.name===i?L.outcome:s.indexOf(e.name)>=0?L.mediators:c.indexOf(e.name)>=0?L.colliders:d.indexOf(e.name)>=0?L.confounds:u.indexOf(e.name)>=0?L.prognostics:"black"}var q=H.select("#nodeNames").selectAll(".nodeName").data(a.nodes).join("text").attr("class","nodeName").text(e=>e.name).attr("x",e=>e.x).attr("y",e=>e.y).attr("fill",e=>Y(e)).attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-family","sans-serif").attr("font-size","12px"),X=H.select("#links").selectAll(".link").data(a.links).join("line").attr("class","link").attr("x1",e=>e.source.x).attr("y1",e=>e.source.y).attr("x2",e=>e.target.x).attr("y2",e=>e.target.y).attr("stroke","black").attr("stroke-width",1).on("mouseover",(function(){"path"===l&&b.b(this).attr("stroke-width",3)})).on("mouseout",(function(){"path"===l&&b.b(this).attr("stroke","black").attr("stroke-width",1)})).on("click",(function(e,t){"path"===l&&E(t)}));var K=H.select("#nodes").selectAll(".node").data(a.nodes).join("ellipse").attr("class","node").attr("rx",50).attr("ry",20).attr("cx",e=>e.x).attr("cy",e=>e.y).attr("fill","white").attr("stroke",e=>Y(e)).attr("stroke-width",e=>function(e){return P.indexOf(e.name)>=0||R(e)?3:1}(e)).attr("stroke-dasharray",e=>e.$custom?"5 5 2 5":"none").attr("cursor","pointer").call(b.a().on("start",(function(e,t){})).on("drag",(function(e,t){"default"===l&&function(e,t,a){b.b(e).attr("cx",t.x).attr("cy",t.y),q.filter(e=>e.id===a.id).attr("x",t.x).attr("y",t.y),X.filter(e=>e.source.id===a.id).attr("x1",t.x).attr("y1",t.y),X.filter(e=>e.target.id===a.id).attr("x2",t.x).attr("y2",t.y),W.filter(e=>e.target.id===a.id).attr("x1",e=>(t.x-e.source.x)/2+e.source.x).attr("y1",e=>(t.y-e.source.y)/2+e.source.y).attr("x2",e=>{let a=t.y-e.source.y,n=t.x-e.source.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(t.x-e.source.x)/2+e.source.x+10*Math.cos(r+Math.PI/5)}).attr("y2",e=>{let a=t.y-e.source.y,n=t.x-e.source.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(t.y-e.source.y)/2+e.source.y-10*Math.sin(r+Math.PI/5)}),W.filter(e=>e.source.id===a.id).attr("x1",e=>(e.target.x-t.x)/2+t.x).attr("y1",e=>(e.target.y-t.y)/2+t.y).attr("x2",e=>{let a=e.target.y-t.y,n=e.target.x-t.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(e.target.x-t.x)/2+t.x+10*Math.cos(r+Math.PI/5)}).attr("y2",e=>{let a=e.target.y-t.y,n=e.target.x-t.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(e.target.y-t.y)/2+t.y-10*Math.sin(r+Math.PI/5)}).attr("stroke","black").attr("stroke-width",1),V.filter(e=>e.target.id===a.id).attr("x1",e=>(t.x-e.source.x)/2+e.source.x).attr("y1",e=>(t.y-e.source.y)/2+e.source.y).attr("x2",e=>{let a=t.y-e.source.y,n=t.x-e.source.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(t.x-e.source.x)/2+e.source.x+10*Math.cos(r-Math.PI/5)}).attr("y2",e=>{let a=t.y-e.source.y,n=t.x-e.source.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(t.y-e.source.y)/2+e.source.y-10*Math.sin(r-Math.PI/5)}),V.filter(e=>e.source.id===a.id).attr("x1",e=>(e.target.x-t.x)/2+t.x).attr("y1",e=>(e.target.y-t.y)/2+t.y).attr("x2",e=>{let a=e.target.y-t.y,n=e.target.x-t.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(e.target.x-t.x)/2+t.x+10*Math.cos(r-Math.PI/5)}).attr("y2",e=>{let a=e.target.y-t.y,n=e.target.x-t.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(e.target.y-t.y)/2+t.y-10*Math.sin(r-Math.PI/5)}).attr("stroke","black").attr("stroke-width",1)}(this,e,t)})).on("end",(function(e,t){"default"===l&&g(t.id,e.x,e.y)}))).on("click",(function(e,t){if(e.stopPropagation(),"path"===l){if(1===z.length&&t.id===z[0].id)return b.b(this).attr("stroke-width",1),void(z=[]);z.push(t),b.b(this).attr("stroke-width",3),2===z.length&&(k(z),z=[])}})).on("mouseover",(function(e,t){"path"===l&&b.b(this).attr("stroke-width",3)})).on("mouseout",(function(e,t){"path"===l&&z.map(e=>e.name).indexOf(t.name)<0&&t.name!==m?b.b(this).attr("stroke-width",1):"default"!==l||R(t)||b.b(this).attr("stroke-width",1)}));const U=["treatment","outcome","confounds","colliders","mediators","prognostics"];_.select("#legend").selectAll(".legendRect").data(U).join("rect").attr("class","legendRect").attr("x",t.width-2*t.margin).attr("y",(e,a)=>t.height-2*t.margin+18*a).attr("width",15).attr("height",15).attr("fill",e=>L[e]),_.select("#legend").selectAll(".legendText").data(U).join("text").attr("class","legendText").attr("x",t.width-2*t.margin+18).attr("y",(e,a)=>t.height-2*t.margin+18*a+9).attr("alignment-baseline","middle").attr("text-anchor","start").attr("fill",e=>L[e]).attr("font-family","sans-serif").attr("font-size","12px").text(e=>e);return r.a.createElement("div",null,r.a.createElement(h.a,{id:"basic-menu",anchorReference:"anchorPosition",anchorPosition:N,style:{},open:S,onClose:D,MenuListProps:{"aria-labelledby":"basic-button"}},r.a.createElement(f.a,{onClick:function(){o===T?(p(""),D()):i===T?(p(T),y(""),D()):(p(T),D())},selected:T===o},"Set as Treatment"),r.a.createElement(f.a,{onClick:function(){i===T?(y(""),D()):o===T?(y(T),p(""),D()):(y(T),D())},selected:T===i},"Set as Outcome"),r.a.createElement(f.a,{onClick:function(){0===P.length&&(x(T),D())}},"Delete from Graph")),r.a.createElement(v.a,{id:"fitScreen",onClick:()=>{_.transition().duration(750).call($.transform,b.d)}},r.a.createElement("a",{style:{height:"24px"},title:"reset zoom"},w)),r.a.createElement("svg",{width:t.width,height:t.height,ref:G,id:C},O,M))};var N=a(421),I=a(432),T=a(437),j=a(433),P=a(434),J=a(412),L=a(430),B=a(413),D=a(435),R=a(436),G=a(419),z=a(96),_=r.a.createElement(J.a,null,"Download"),H=r.a.createElement(B.a,{component:"legend"},"Select at least one");const $=e=>{let{open:t=!1,nodelinks:a={},treatment:l="",outcome:o="",confounds:i=[],colliders:s=[],mediators:c=[],prognostics:d=[],handleClose:u}=e;const[h,f]=r.a.useState({nodelinkCheck:!0,treatmentCheck:!1,outcomeCheck:!1,confoundsCheck:!1,mediatorsCheck:!1,collidersCheck:!1,prognosticsCheck:!1}),[g,x]=r.a.useState(!1),[p,y]=r.a.useState(""),[k,E]=r.a.useState("DAG");function b(e){h[e]=!h[e];let t=Object.values(h).filter(e=>e).length<1;f({...h}),x(t)}Object(n.useEffect)(()=>{let e={};if(h.nodelinkCheck){e.nodes=JSON.parse(JSON.stringify(a.nodes));for(let t of e.nodes)delete t.children,delete t.parents;e.links=JSON.parse(JSON.stringify(a.links))}h.treatmentCheck&&(e.treatment=l),h.outcomeCheck&&(e.outcome=o),h.confoundsCheck&&(e.confounds=i),h.mediatorsCheck&&(e.mediators=c),h.collidersCheck&&(e.colliders=s),h.prognosticsCheck&&(e.prognostics=d),y(e)},[h,a,l,o,i,s,c,d]);return r.a.createElement("div",null,r.a.createElement(I.a,{open:t,onClose:u,fullWidth:!0,maxWidth:"md"},_,r.a.createElement(j.a,null,r.a.createElement(G.a,{style:{marginBottom:"24px"},defaultValue:k,id:"outlined-basic",label:"Filename",variant:"standard",onChange:e=>function(e){E(e.target.value)}(e)}),r.a.createElement(P.a,null,"Select the data you would like to include. Your file will be saved as ",r.a.createElement("i",null,k,".json"),"."),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(L.a,{required:!0,error:g,component:"fieldset",sx:{m:3},variant:"standard"},H,r.a.createElement(D.a,{style:{width:"250px"}},r.a.createElement(R.a,{control:r.a.createElement(N.a,{checked:h.nodelinkCheck,onChange:()=>b("nodelinkCheck")}),label:"Node-Link"}),r.a.createElement(R.a,{control:r.a.createElement(N.a,{checked:h.treatmentCheck,onChange:()=>b("treatmentCheck")}),label:"Treatment"}),r.a.createElement(R.a,{control:r.a.createElement(N.a,{checked:h.outcomeCheck,onChange:()=>b("outcomeCheck")}),label:"Outcome"}),r.a.createElement(R.a,{control:r.a.createElement(N.a,{checked:h.confoundsCheck,onChange:()=>b("confoundsCheck")}),label:"Confounds"}),r.a.createElement(R.a,{control:r.a.createElement(N.a,{checked:h.mediatorsCheck,onChange:()=>b("mediatorsCheck")}),label:"Mediators"}),r.a.createElement(R.a,{control:r.a.createElement(N.a,{checked:h.collidersCheck,onChange:()=>b("collidersCheck")}),label:"Colliders"}),r.a.createElement(R.a,{control:r.a.createElement(N.a,{checked:h.prognosticsCheck,onChange:()=>b("prognosticsCheck")}),label:"Prognostics"}))),r.a.createElement(G.a,{style:{margin:"24px 24px 0px 0px"},id:"outlined-multiline-flexible",multiline:!0,fullWidth:!0,maxRows:20,value:JSON.stringify(p,null,4),InputProps:{readOnly:!0}}))),r.a.createElement(T.a,null,r.a.createElement(m.a,{onClick:u},"Cancel"),r.a.createElement(m.a,{onClick:function(){let e=new Blob([JSON.stringify(p,null,4)],{type:"application/json",name:k+".json"});Object(z.saveAs)(e,k+".json")}},"Save"))))};var F=a(194),W=a(417),V=a(427),Y=a(415),q=r.a.createElement(J.a,null,"Add or Edit Tags");const X=e=>{let{tagNode:t="",tagColors:a={},attrTags:n=[],open:l=!1,handleTagClose:i,updateTag:s,deleteTag:c}=e;const[d,u]=r.a.useState(""),[h,f]=r.a.useState(!1),[g,x]=r.a.useState("#000000");let p={width:"100%",height:"100%",borderRadius:"4px",background:""+g},y={display:n.length>0?"block":"none",margin:"24px 10px 0px 0px"};return r.a.createElement("div",null,r.a.createElement(I.a,{open:l,onClose:i},q,r.a.createElement(j.a,null,r.a.createElement(P.a,null,"You are editing tags for the node: ",r.a.createElement("i",null,t)),r.a.createElement(Y.a,{style:y,direction:"row",spacing:1},n.map((e,t)=>r.a.createElement(V.a,{label:e,variant:"outlined",onDelete:()=>(e=>{c(e)})(e),sx:{color:a[e]}}))),r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement(W.a,{disablePortal:!0,freeSolo:!0,options:Object.keys(a),sx:{margin:"24px 10px 0px 0px",width:"300px"},onChange:(e,t)=>function(e,t){u(t),x(a[t])}(0,t),onInputChange:e=>function(e){u(e.target.value)}(e),renderInput:e=>r.a.createElement(G.a,Object(o.a)({},e,{label:"Tag Name"}))}),r.a.createElement("div",{style:{margin:"24px 24px 0px 0px",width:"48px",height:"48px",padding:"4px",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.1)",display:"inline-block",cursor:"pointer"},onClick:()=>{f(!h)}},r.a.createElement("div",{style:p}),h?r.a.createElement("div",{style:{position:"fixed",zIndex:"1301"}},r.a.createElement("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:()=>{f(!1)}}),r.a.createElement(F.a,{color:g,onChange:e=>{x(e.hex)}})):null))),r.a.createElement(T.a,null,r.a.createElement(m.a,{onClick:i},"Close"),r.a.createElement(m.a,{onClick:()=>{""===d||s(g,d),x("#000000")}},"Add"))))};var K=r.a.createElement(P.a,null,"Add Custom Node");const U=e=>{let{open:t=!1,handleNodeClose:a,addAttribute:n,addCustom:l}=e;const[o,i]=r.a.useState("");return r.a.createElement("div",null,r.a.createElement(I.a,{open:t,onClose:a},r.a.createElement(j.a,null,K,r.a.createElement(G.a,{style:{margin:"24px 24px 0px 0px"},id:"outlined-basic",label:"Variable Name",variant:"outlined",onChange:e=>function(e){i(e.target.value)}(e)})),r.a.createElement(T.a,null,r.a.createElement(m.a,{onClick:a},"Cancel"),r.a.createElement(m.a,{onClick:function(){""===o||(l(o),i("")),a()}},"Add"))))};var Q=a(428),Z=a(431),ee=a(426),te=a(191),ae=a.n(te),ne=a(192),re=a.n(ne),le=a(193),oe=a.n(le),ie=a(190),se=a.n(ie),ce=r.a.createElement(se.a,null),de=r.a.createElement(ae.a,null),ue=r.a.createElement(re.a,null);const me=e=>{let{attributes:t=[],graph:a,_svg:l="svgDAG",_dag:m,_colliders:h,_mediators:f,_confounds:g,_prognostics:x}=e;const[p,y]=r.a.useState({nodes:[],links:[]}),[k,b]=r.a.useState("default"),[C,S]=r.a.useState(!1),[w,O]=r.a.useState(!1),[M,N]=r.a.useState(!1),[I,T]=r.a.useState(),[j,P]=r.a.useState({}),[J,L]=r.a.useState(""),[B,D]=r.a.useState([]),[R,_]=r.a.useState([]),[H,F]=r.a.useState([]),[V,Y]=r.a.useState([]),[q,K]=r.a.useState({}),[te,ae]=r.a.useState([]),[ne,re]=r.a.useState(""),[le,ie]=r.a.useState(""),[se,me]=r.a.useState({}),[he,fe]=r.a.useState(new Set),ge={height:500,width:1e3,margin:60};function xe(){return(new Date).getTime()+Math.floor(98*Math.random())}function pe(e,t,a,n,r){let l=document.getElementById(m),o=JSON.stringify(e),i=document.getElementById(h),s=document.getElementById(f),c=document.getElementById(g),d=document.getElementById(x);var u;l&&(l.value=o,(u=document.createEvent("HTMLEvents")).initEvent("input",!1,!0),l.dispatchEvent(u));i&&(i.value=JSON.stringify(t),(u=document.createEvent("HTMLEvents")).initEvent("input",!1,!0),i.dispatchEvent(u));s&&(s.value=JSON.stringify(a),(u=document.createEvent("HTMLEvents")).initEvent("input",!1,!0),s.dispatchEvent(u));c&&(c.value=JSON.stringify(n),(u=document.createEvent("HTMLEvents")).initEvent("input",!1,!0),c.dispatchEvent(u));d&&(d.value=JSON.stringify(r),(u=document.createEvent("HTMLEvents")).initEvent("input",!1,!0),d.dispatchEvent(u))}function ye(e,t,a,n){if(void 0===t&&(t=!1),void 0===a&&(a=ge.width/2),void 0===n&&(n=ge.height/2),te.indexOf(e)<0){const r=xe(),l={nodes:[...p.nodes,{x:a,y:n,id:r,name:e,parents:new Set,children:new Set,$custom:q[e]?q[e].$custom:t,tags:q[e]?q[e].tags:[]}],links:[...p.links]};y(l),ae([...te,e])}}function ke(e){let t=te.indexOf(e);te.splice(t,1),ae([...te]);let a=p.nodes.filter(t=>t.name!==e),n=p.links.filter(t=>t.target.name!==e&&t.source.name!==e);y({nodes:[...a],links:[...n]}),e===ne&&re(""),e===le&&ie("")}function Ee(e){re(e)}function be(e){ie(e)}Object(n.useEffect)(()=>{if(a){let t=function(e){var t=Object(d.a)().domain(Object(u.a)(e.nodes,e=>e.x)).range([ge.margin,ge.width-ge.margin]),a=Object(d.a)().domain(Object(u.a)(e.nodes,e=>e.y)).range([ge.margin,ge.height-ge.margin]);let n=JSON.parse(JSON.stringify(e)),r=n.nodes,l=n.links,o=new Set,i={};for(let e of r){if(!e.id){let t=xe();for(;o.has(t);)t=xe();e.id=t}o.add(e.id),e.x=t(e.x),e.y=a(e.y),e.children=new Set,e.parents=new Set,i[e.name]={$custom:!1,tags:[]}}fe(o),K(i),ae(Object.keys(i));for(let e of l){let t=e.source.name?e.source.name:e.source,a=e.target.name?e.target.name:e.target,n=r.filter(e=>e.name===t)[0],l=r.filter(e=>e.name===a)[0];n.children.add(l.id),l.parents.add(n.id),e.source={...r.filter(e=>e.name===t)[0]},e.target={...r.filter(e=>e.name===a)[0]},delete e.source.children,delete e.source.parents,delete e.target.children,delete e.target.parents}return n}(a);y(t);let n=document.getElementById(m),r=JSON.stringify(t);if(n){n.value=r;var e=document.createEvent("HTMLEvents");e.initEvent("input",!1,!0),n.dispatchEvent(e)}}},[a]),Object(n.useEffect)(()=>{if(t&&t.length>0&&!a){let e={};for(let a of t)e[a]={$custom:!1,tags:[]};K(e)}},[t]),Object(n.useEffect)(()=>{if(ne.length>0&&le.length>0){let e=Array.from(we(ne,le)),t=[];for(let a of e)t.push(p.nodes.filter(e=>e.id===a)[0].name);let a=Array.from(Oe(ne,le)),n=Me(ne,le),r=Se(ne,le,a.map(e=>e.id),n.map(e=>e.id));D(t),_(a.map(e=>e.name)),F(n.map(e=>e.name)),Y(r.map(e=>e.name)),pe(p,t,a,n,r)}else D([]),_([]),F([]),Y([]),pe(p,[],[],[],[])},[ne,le,p]);function ve(){!function(e,t,a,n,r){var l="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e))),o=document.createElement("canvas"),i=o.getContext("2d");o.width=t,o.height=a;var s=new Image;s.onload=function(){i.clearRect(0,0,t,a),i.drawImage(s,0,0,t,a),o.toBlob((function(e){var t=Math.round(e.length/1024)+" KB";r&&r(e,t)}))},s.src=l}(function(e){e.setAttribute("xlink","http://www.w3.org/1999/xlink");var t=(new XMLSerializer).serializeToString(e);return t=(t=t.replace(/(\w+)?:?xlink=/g,"xmlns:xlink=")).replace(/NS\d+:href/g,"xlink:href")}(Object(c.a)("#"+l).node()),2*ge.width,2*ge.height,0,(function(e,t){Object(z.saveAs)(e,"DAG.png")}))}function Ce(e,t){if(void 0===t&&(t=null),e.id===t)return[];let a=Array.from(e.children);for(let n of e.children){let e=p.nodes.filter(e=>e.id===n)[0];a=a.concat(Ce(e,t))}return a}function Se(e,t,a,n){if(void 0===a&&(a=[]),void 0===n&&(n=[]),0===p.nodes.length||0===p.links.length)return[];if(""===e||""===t)return[];let r=p.nodes.filter(t=>t.name===e)[0].id,l=p.nodes.filter(e=>e.name===t)[0].id,o=[];for(let e of p.nodes){if(e.id===r)continue;let t=a.indexOf(e.id)>=0,i=n.indexOf(e.id)>=0,s=e.children.has(l),c=e.children.has(r);!s||c||t||i||o.push(e)}return o}function we(e,t){if(0===p.nodes.length||0===p.links.length)return[];if(""===e||""===t)return[];let a=p.nodes.filter(t=>t.name===e)[0],n=p.nodes.filter(e=>e.name===t)[0],r=Ce(a,n.id),l=new Set(Ce(n));return new Set([...r].filter(e=>l.has(e)))}function Oe(e,t){if(0===p.nodes.length||0===p.links.length)return[];if(""===e||""===t)return[];let a=p.nodes.filter(t=>t.name===e)[0],n=p.nodes.filter(e=>e.name===t)[0].id,r=function e(t,a){if(t.id===a)return[t];if(t.id!==a&&0===t.children.size)return[];let n=[];for(let r of t.children){let t=e(p.nodes.filter(e=>e.id===r)[0],a);t.length>0&&(n=n.concat(t))}return n.map(e=>[t].concat(e))}(a,n),l=[];for(let e of r){let t=e.filter(e=>e.id!==a.id&&e.id!==n);l=l.concat(t)}return new Set(l)}function Me(e,t){if(0===p.nodes.length||0===p.links.length)return[];if(""===e||""===t)return[];let a=[],n=p.nodes.filter(t=>t.name===e)[0].id;for(let r of p.nodes){let l=new Set(Ce(r,n)),o=new Set(p.nodes.filter(e=>l.has(e.id)).map(e=>e.name));o.has(e)&&o.has(t)&&a.push(r)}return a}Object(i.a)({palette:{grey:{light:s.a[300],main:s.a[500],dark:s.a[700],contrastText:"#fff"}}});let Ae={height:"24px"},Ne={height:"48px",borderRadius:"24px",marginLeft:"10px","& .MuiOutlinedInput-input":{height:"12px"},"& .MuiOutlinedInput-root":{padding:"11px"},"& .MuiInputLabel-formControl":{top:"-1px"}};return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(E,{attributes:Object.keys(q),added:te,treatment:ne,outcome:le,addAttribute:ye,deleteAttribute:ke,changeTreatment:Ee,changeOutcome:be,handleAddTag:e=>{T(e),N(!0)},handleNodeOpen:()=>{O(!0)}}),r.a.createElement($,{open:C,nodelinks:p,treatment:ne,outcome:le,confounds:H,colliders:B,mediators:R,prognostics:V,handleClose:()=>{S(!1)}}),r.a.createElement(U,{open:w,handleNodeClose:()=>{O(!1)},addAttribute:ye,addCustom:function(e){let t=JSON.parse(JSON.stringify(q));t[e]={$custom:!0,tags:[]},K(t),ye(e,!0)}}),r.a.createElement(X,{tagNode:I,tagColors:j,attrTags:q[I]?q[I].tags:[],open:M,handleTagClose:()=>{N(!1)},updateTag:function(e,t){if(q[I].tags&&q[I].tags.indexOf(t)>=0)return;let a={...p},n=a.nodes.filter(e=>e.name===I)[0];n.tags?n.tags.push(t):n.tags=[t],y(a);let r=JSON.parse(JSON.stringify(q));r[I].tags.push(t),K(r),j[t]=e,P({...j})},deleteTag:function(e){let t={...p},a=t.nodes.filter(e=>e.name===I)[0],n=a.tags.indexOf(e);a.tags.splice(n,1),y(t);let r=JSON.parse(JSON.stringify(q));n=r[I].tags.indexOf(e),r[I].tags.splice(n,1),K(r)}}),r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",width:"100%",alignItems:"center",marginBottom:"20px"}},r.a.createElement(ee.a,{style:{marginBottom:"0px",height:"48px","& .MuiButtonBase-root":{height:"48px"}},value:k,exclusive:!0,onChange:(e,t)=>function(e,t){b(t)}(0,t),"aria-label":"text alignment"},r.a.createElement(Z.a,{value:"default",alt:"select"},r.a.createElement("a",{style:Ae,title:"select"},ce)),r.a.createElement(Z.a,{value:"path",alt:"edit links"},r.a.createElement("a",{style:Ae,title:"edit links"},r.a.createElement(oe.a,{style:{transform:"rotate(-45deg)"}})))),r.a.createElement(W.a,{disablePortal:!0,id:"combo-box-demo",options:te.concat(Object.keys(j).map(e=>"tag:"+e)),sx:{width:300},onChange:(e,t)=>function(e,t){L(t)}(0,t),renderInput:e=>r.a.createElement(G.a,Object(o.a)({},e,{sx:Ne,label:"Search"}))}),r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"none"}},r.a.createElement(v.a,{id:"downloadSVG",onClick:()=>ve()},r.a.createElement("a",{style:Ae,title:"save image"},de)),r.a.createElement(v.a,{onClick:()=>(()=>{let e=we(ne,le),t=[];for(let a of e)t.push(p.nodes.filter(e=>e.id===a)[0].name);let a=Array.from(Oe(ne,le)),n=Me(ne,le),r=Se(ne,le,a.map(e=>e.id),n.map(e=>e.id));D(t),_(a.map(e=>e.name)),F(n.map(e=>e.name)),Y(r.map(e=>e.name)),S(!0)})()},r.a.createElement("a",{style:Ae,title:"download JSON"},ue)))),r.a.createElement(Q.a,{elevation:0,variant:"outlined"},r.a.createElement(A,{layout:ge,nodelinks:p,mode:k,treatment:ne,outcome:le,mediators:R,colliders:B,confounds:H,prognostics:V,search:J,updateNodePos:function(e,t,a){let n={...p};for(let r of n.nodes)if(r.id===e){r.x=t,r.y=a;break}for(let r of n.links)r.source.id===e&&(r.source.x=t,r.source.y=a),r.target.id===e&&(r.target.x=t,r.target.y=a);y(n)},deleteAttribute:ke,changeTreatment:Ee,changeOutcome:be,updateLinks:function(e){for(let t of p.links)if(t.source.id===e[0].id&&t.target.id===e[1].id||t.target.id===e[0].id&&t.source.id===e[1].id)return;if(t=e[0],a=e[1],new Set(Ce(a)).has(t.id)&&(alert("This link cannot be added. The DAG must be acyclic."),1))return;var t,a;for(let t of p.nodes)t.id===e[0].id?t.children.add(e[1].id):t.id===e[1].id&&t.parents.add(e[0].id);let n=JSON.parse(JSON.stringify(e));delete n[0].parents,delete n[0].children,delete n[1].parents,delete n[1].children;const r={nodes:[...p.nodes],links:[...p.links,{source:n[0],target:n[1]}]};y(r)},deleteLinks:function(e){const t=p.links.filter(t=>!(t.source.id===e.source.id&&t.target.id===e.target.id));for(let t of p.nodes)t.id===e.source.id?t.children.delete(e.target.id):t.id===e.target.id&&t.parents.delete(e.source.id);const a={nodes:[...p.nodes],links:[...t]};y(a)},_svg:l}))))};var he=r.a.createElement("a",{href:"https://github.com/causalvis/causalvis"},"Causalvis Python package"),fe=r.a.createElement("a",{href:"https://dl.acm.org/doi/full/10.1145/3544548.3581236"},"our paper"),ge=r.a.createElement(me,null);const xe=()=>r.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"}},r.a.createElement("div",null,r.a.createElement("h1",{style:{fontFamily:"sans-serif"}},"Causalvis"),r.a.createElement("p",{style:{fontFamily:"sans-serif"}},"This is a browser demo of the DAG module of the ",he,". For more information about this work, please refer to ",fe,"."),ge));Object(l.render)(r.a.createElement(xe,null),document.querySelector("#app"))}},[[237,1,2]]]);
//# sourceMappingURL=app.b129a5f0.js.map