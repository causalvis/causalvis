(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{237:function(e,t,a){e.exports=a(354)},354:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(32),o=a(95),i=a(195),s=a(181),c=a(154),d=a(418),u=a(416),m=a(425),h=a(196),g=a(423);const f=e=>{let{value:t=[],color:a="black",isAdded:n=!1,treatment:l,outcome:o,addAttribute:i,deleteAttribute:s,changeTreatment:c,changeOutcome:d,handleAddTag:u}=e;const f={grey:{rgb:"rgb(158, 158, 158)",rgba:"rgba(158, 158, 158, 0.05)"},treatment:{rgb:"rgb(78, 121, 167)",rgba:"rgba(78, 121, 167, 0.05)"},outcome:{rgb:"rgb(242, 142, 44)",rgba:"rgba(242, 142, 44, 0.05)"},black:{rgb:"rgb(0, 0, 0)",rgba:"rgba(0, 0, 0, 0.05)"}},[p,x]=r.a.useState(!1),[y,b]=r.a.useState(null);function k(){b(null),x(!1)}const E={width:"100%",marginBottom:"5px",color:f[a].rgb,borderColor:f[a].rgb,"&:hover":{borderColor:f[a].rgb,backgroundColor:f[a].rgba}};return r.a.createElement("div",null,r.a.createElement(m.a,{sx:E,onClick:()=>i(t),onContextMenu:e=>function(e){e.preventDefault(),n&&(x(!p),b({left:e.clientX+2,top:e.clientY-6}))}(e),variant:"outlined"},r.a.createElement("a",{title:"click to add"},t)),r.a.createElement(h.a,{id:"basic-menu",anchorReference:"anchorPosition",anchorPosition:y,style:{},open:p,onClose:k,MenuListProps:{"aria-labelledby":"basic-button"}},r.a.createElement(g.a,{onClick:function(){l===t?(c(""),k()):o===t?(c(t),d(""),k()):(c(t),k())},selected:t===l},"Set as Treatment"),r.a.createElement(g.a,{onClick:function(){o===t?(d(""),k()):l===t?(d(t),c(""),k()):(d(t),k())},selected:t===o},"Set as Outcome"),r.a.createElement(g.a,{onClick:function(){u(t),k()}},"Edit Tags"),r.a.createElement(g.a,{onClick:function(){s(t),k()}},"Delete from Graph")))};var p=a(183),x=a.n(p),y=r.a.createElement(x.a,null),b=r.a.createElement("a",{title:"click to add"},"Add Node");const k=e=>{let{attributes:t=[],added:a=[],treatment:n,outcome:l,addAttribute:o,deleteAttribute:i,changeTreatment:s,changeOutcome:c,handleAddTag:d,handleNodeOpen:u}=e;function h(e){return n===e?"treatment":l===e?"outcome":a.indexOf(e)>=0?"black":"grey"}return r.a.createElement("div",null,r.a.createElement(m.a,{style:{width:"100%",marginBottom:"5px",width:"150px"},startIcon:y,variant:"contained",onClick:()=>u()},b),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"150px",marginRight:"20px",height:"500px",overflow:"scroll"}},t.map((e,t)=>r.a.createElement(f,{key:t,value:e,isAdded:a.indexOf(e)>=0,color:h(e),treatment:n,outcome:l,addAttribute:o,deleteAttribute:i,changeTreatment:s,changeOutcome:c,handleAddTag:d}))))};var E=a(27),v=a(429),C=a(185),w=a.n(C),S=r.a.createElement(w.a,null),O=r.a.createElement("g",null,r.a.createElement("g",{id:"links"}),r.a.createElement("g",{id:"nodes"}),r.a.createElement("g",{id:"nodeNames"})),M=r.a.createElement("g",{id:"legend"});const A=e=>{let{layout:t={height:500,width:1e3,margin:60},nodelinks:a={},mode:l="default",treatment:o="",outcome:i="",mediators:s=[],colliders:c=[],confounds:d=[],prognostics:u=[],search:m,updateNodePos:f,deleteAttribute:p,changeTreatment:x,changeOutcome:y,updateLinks:b,deleteLinks:k,_svg:C}=e;const[w,A]=r.a.useState(!1),[T,N]=r.a.useState(null),[I,j]=r.a.useState(null),[P,J]=r.a.useState([]),[D,L]=r.a.useState({treatment:"#4e79a7",outcome:"#f28e2c",confounds:"#e15759",colliders:"#76b7b2",mediators:"#59a14f",prognostics:"#b07AA1"});function B(){N(null),j(null),A(!1)}function G(e){return!!m&&(m===e.name||!!(m.startsWith("tag:")&&e.tags&&e.tags.indexOf(m.slice(4))>=0))}Object(n.useEffect)(()=>{m?U.filter(e=>G(e)).attr("stroke-width","3px"):U.attr("stroke-width","1px")},[m]),Object(n.useEffect)(()=>{for(let e of s)U.filter(t=>t.name===e).attr("stroke",D.mediators),q.filter(t=>t.name===e).attr("fill",D.mediators);for(let e of c)U.filter(t=>t.name===e).attr("stroke",D.colliders),q.filter(t=>t.name===e).attr("fill",D.colliders);for(let e of d)U.filter(t=>t.name===e).attr("stroke",D.confounds),q.filter(t=>t.name===e).attr("fill",D.confounds)},[s,c,d]);const R=Object(n.useRef)("svgDAG");let z=[],_=E.b(R.current),H=_.select("g");const $=E.c().extent([[0,0],[t.width,t.height]]).scaleExtent([.1,8]).on("zoom",(function(e){let{transform:t}=e;H.attr("transform",t)}));function F(e,t,a){let n;return n=e<0&&t<0?2*Math.PI-a:e<0&&t>0?Math.PI+a:e>0&&t>0?Math.PI-a:0===e&&t<0?0:0===e&&t>0?Math.PI:e>0&&0===t?Math.PI/2:e<0&&0===t?Math.PI/2*3:a,n}_.call($);var W=H.select("#links").selectAll(".arrowleft").data(a.links).join("line").attr("class","arrowleft").attr("x1",e=>(e.target.x-e.source.x)/2+e.source.x).attr("y1",e=>(e.target.y-e.source.y)/2+e.source.y).attr("x2",e=>{let t=e.target.y-e.source.y,a=e.target.x-e.source.x,n=F(t,a,Math.atan(Math.abs(t/a)));return(e.target.x-e.source.x)/2+e.source.x+10*Math.cos(n+Math.PI/5)}).attr("y2",e=>{let t=e.target.y-e.source.y,a=e.target.x-e.source.x,n=F(t,a,Math.atan(Math.abs(t/a)));return(e.target.y-e.source.y)/2+e.source.y-10*Math.sin(n+Math.PI/5)}).attr("stroke","black").attr("stroke-width",1),V=H.select("#links").selectAll(".arrowright").data(a.links).join("line").attr("class","arrowright").attr("x1",e=>(e.target.x-e.source.x)/2+e.source.x).attr("y1",e=>(e.target.y-e.source.y)/2+e.source.y).attr("x2",e=>{let t=e.target.y-e.source.y,a=e.target.x-e.source.x,n=F(t,a,Math.atan(Math.abs(t/a)));return(e.target.x-e.source.x)/2+e.source.x+10*Math.cos(n-Math.PI/5)}).attr("y2",e=>{let t=e.target.y-e.source.y,a=e.target.x-e.source.x,n=F(t,a,Math.atan(Math.abs(t/a)));return(e.target.y-e.source.y)/2+e.source.y-10*Math.sin(n-Math.PI/5)}).attr("stroke","black").attr("stroke-width",1);function Y(e){return e.name===o?D.treatment:e.name===i?D.outcome:s.indexOf(e.name)>=0?D.mediators:c.indexOf(e.name)>=0?D.colliders:d.indexOf(e.name)>=0?D.confounds:u.indexOf(e.name)>=0?D.prognostics:"black"}var q=H.select("#nodeNames").selectAll(".nodeName").data(a.nodes).join("text").attr("class","nodeName").text(e=>e.name).attr("x",e=>e.x).attr("y",e=>e.y).attr("fill",e=>Y(e)).attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-family","sans-serif").attr("font-size","12px"),K=H.select("#links").selectAll(".link").data(a.links).join("line").attr("class","link").attr("x1",e=>e.source.x).attr("y1",e=>e.source.y).attr("x2",e=>e.target.x).attr("y2",e=>e.target.y).attr("stroke","black").attr("stroke-width",1).on("mouseover",(function(){"path"===l&&E.b(this).attr("stroke-width",3)})).on("mouseout",(function(){"path"===l&&E.b(this).attr("stroke","black").attr("stroke-width",1)})).on("click",(function(e,t){"path"===l&&k(t)}));var U=H.select("#nodes").selectAll(".node").data(a.nodes).join("ellipse").attr("class","node").attr("rx",50).attr("ry",20).attr("cx",e=>e.x).attr("cy",e=>e.y).attr("fill","white").attr("stroke",e=>Y(e)).attr("stroke-width",e=>function(e){return P.indexOf(e.name)>=0||G(e)?3:1}(e)).attr("stroke-dasharray",e=>e.$custom?"5 5 2 5":"none").attr("cursor","pointer").call(E.a().on("start",(function(e,t){})).on("drag",(function(e,t){"default"===l&&function(e,t,a){E.b(e).attr("cx",t.x).attr("cy",t.y),q.filter(e=>e.id===a.id).attr("x",t.x).attr("y",t.y),K.filter(e=>e.source.id===a.id).attr("x1",t.x).attr("y1",t.y),K.filter(e=>e.target.id===a.id).attr("x2",t.x).attr("y2",t.y),W.filter(e=>e.target.id===a.id).attr("x1",e=>(t.x-e.source.x)/2+e.source.x).attr("y1",e=>(t.y-e.source.y)/2+e.source.y).attr("x2",e=>{let a=t.y-e.source.y,n=t.x-e.source.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(t.x-e.source.x)/2+e.source.x+10*Math.cos(r+Math.PI/5)}).attr("y2",e=>{let a=t.y-e.source.y,n=t.x-e.source.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(t.y-e.source.y)/2+e.source.y-10*Math.sin(r+Math.PI/5)}),W.filter(e=>e.source.id===a.id).attr("x1",e=>(e.target.x-t.x)/2+t.x).attr("y1",e=>(e.target.y-t.y)/2+t.y).attr("x2",e=>{let a=e.target.y-t.y,n=e.target.x-t.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(e.target.x-t.x)/2+t.x+10*Math.cos(r+Math.PI/5)}).attr("y2",e=>{let a=e.target.y-t.y,n=e.target.x-t.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(e.target.y-t.y)/2+t.y-10*Math.sin(r+Math.PI/5)}).attr("stroke","black").attr("stroke-width",1),V.filter(e=>e.target.id===a.id).attr("x1",e=>(t.x-e.source.x)/2+e.source.x).attr("y1",e=>(t.y-e.source.y)/2+e.source.y).attr("x2",e=>{let a=t.y-e.source.y,n=t.x-e.source.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(t.x-e.source.x)/2+e.source.x+10*Math.cos(r-Math.PI/5)}).attr("y2",e=>{let a=t.y-e.source.y,n=t.x-e.source.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(t.y-e.source.y)/2+e.source.y-10*Math.sin(r-Math.PI/5)}),V.filter(e=>e.source.id===a.id).attr("x1",e=>(e.target.x-t.x)/2+t.x).attr("y1",e=>(e.target.y-t.y)/2+t.y).attr("x2",e=>{let a=e.target.y-t.y,n=e.target.x-t.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(e.target.x-t.x)/2+t.x+10*Math.cos(r-Math.PI/5)}).attr("y2",e=>{let a=e.target.y-t.y,n=e.target.x-t.x,r=F(a,n,Math.atan(Math.abs(a/n)));return(e.target.y-t.y)/2+t.y-10*Math.sin(r-Math.PI/5)}).attr("stroke","black").attr("stroke-width",1)}(this,e,t)})).on("end",(function(e,t){"default"===l&&f(t.id,e.x,e.y)}))).on("click",(function(e,t){if(e.stopPropagation(),"path"===l){if(1===z.length&&t.id===z[0].id)return E.b(this).attr("stroke-width",1),void(z=[]);z.push(t),E.b(this).attr("stroke-width",3),2===z.length&&(b(z),z=[])}})).on("mouseover",(function(e,t){"path"===l&&E.b(this).attr("stroke-width",3)})).on("mouseout",(function(e,t){"path"===l&&z.map(e=>e.name).indexOf(t.name)<0&&t.name!==m?E.b(this).attr("stroke-width",1):"default"!==l||G(t)||E.b(this).attr("stroke-width",1)}));const X=["treatment","outcome","confounds","colliders","mediators","prognostics"];_.select("#legend").selectAll(".legendRect").data(X).join("rect").attr("class","legendRect").attr("x",t.width-2*t.margin).attr("y",(e,a)=>t.height-2*t.margin+18*a).attr("width",15).attr("height",15).attr("fill",e=>D[e]),_.select("#legend").selectAll(".legendText").data(X).join("text").attr("class","legendText").attr("x",t.width-2*t.margin+18).attr("y",(e,a)=>t.height-2*t.margin+18*a+9).attr("alignment-baseline","middle").attr("text-anchor","start").attr("fill",e=>D[e]).attr("font-family","sans-serif").attr("font-size","12px").text(e=>e);return r.a.createElement("div",null,r.a.createElement(h.a,{id:"basic-menu",anchorReference:"anchorPosition",anchorPosition:T,style:{},open:w,onClose:B,MenuListProps:{"aria-labelledby":"basic-button"}},r.a.createElement(g.a,{onClick:function(){o===I?(x(""),B()):i===I?(x(I),y(""),B()):(x(I),B())},selected:I===o},"Set as Treatment"),r.a.createElement(g.a,{onClick:function(){i===I?(y(""),B()):o===I?(y(I),x(""),B()):(y(I),B())},selected:I===i},"Set as Outcome"),r.a.createElement(g.a,{onClick:function(){0===P.length&&(p(I),B())}},"Delete from Graph")),r.a.createElement(v.a,{id:"fitScreen",onClick:()=>{_.transition().duration(750).call($.transform,E.d)}},r.a.createElement("a",{style:{height:"24px"},title:"reset zoom"},S)),r.a.createElement("svg",{width:t.width,height:t.height,ref:R,id:C},O,M))};var T=a(421),N=a(432),I=a(437),j=a(433),P=a(434),J=a(412),D=a(430),L=a(413),B=a(435),G=a(436),R=a(419),z=a(96),_=r.a.createElement(J.a,null,"Download"),H=r.a.createElement(L.a,{component:"legend"},"Select at least one");const $=e=>{let{open:t=!1,nodelinks:a={},treatment:l="",outcome:o="",confounds:i=[],colliders:s=[],mediators:c=[],prognostics:d=[],handleClose:u}=e;const[h,g]=r.a.useState({nodelinkCheck:!0,treatmentCheck:!1,outcomeCheck:!1,confoundsCheck:!1,mediatorsCheck:!1,collidersCheck:!1,prognosticsCheck:!1}),[f,p]=r.a.useState(!1),[x,y]=r.a.useState(""),[b,k]=r.a.useState("DAG");function E(e){h[e]=!h[e];let t=Object.values(h).filter(e=>e).length<1;g({...h}),p(t)}Object(n.useEffect)(()=>{let e={};if(h.nodelinkCheck){e.nodes=JSON.parse(JSON.stringify(a.nodes));for(let t of e.nodes)delete t.children,delete t.parents;e.links=JSON.parse(JSON.stringify(a.links))}h.treatmentCheck&&(e.treatment=l),h.outcomeCheck&&(e.outcome=o),h.confoundsCheck&&(e.confounds=i),h.mediatorsCheck&&(e.mediators=c),h.collidersCheck&&(e.colliders=s),h.prognosticsCheck&&(e.prognostics=d),y(e)},[h,a,l,o,i,s,c,d]);return r.a.createElement("div",null,r.a.createElement(N.a,{open:t,onClose:u,fullWidth:!0,maxWidth:"md"},_,r.a.createElement(j.a,null,r.a.createElement(R.a,{style:{marginBottom:"24px"},defaultValue:b,id:"outlined-basic",label:"Filename",variant:"standard",onChange:e=>function(e){k(e.target.value)}(e)}),r.a.createElement(P.a,null,"Select the data you would like to include. Your file will be saved as ",r.a.createElement("i",null,b,".json"),"."),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(D.a,{required:!0,error:f,component:"fieldset",sx:{m:3},variant:"standard"},H,r.a.createElement(B.a,{style:{width:"250px"}},r.a.createElement(G.a,{control:r.a.createElement(T.a,{checked:h.nodelinkCheck,onChange:()=>E("nodelinkCheck")}),label:"Node-Link"}),r.a.createElement(G.a,{control:r.a.createElement(T.a,{checked:h.treatmentCheck,onChange:()=>E("treatmentCheck")}),label:"Treatment"}),r.a.createElement(G.a,{control:r.a.createElement(T.a,{checked:h.outcomeCheck,onChange:()=>E("outcomeCheck")}),label:"Outcome"}),r.a.createElement(G.a,{control:r.a.createElement(T.a,{checked:h.confoundsCheck,onChange:()=>E("confoundsCheck")}),label:"Confounds"}),r.a.createElement(G.a,{control:r.a.createElement(T.a,{checked:h.mediatorsCheck,onChange:()=>E("mediatorsCheck")}),label:"Mediators"}),r.a.createElement(G.a,{control:r.a.createElement(T.a,{checked:h.collidersCheck,onChange:()=>E("collidersCheck")}),label:"Colliders"}),r.a.createElement(G.a,{control:r.a.createElement(T.a,{checked:h.prognosticsCheck,onChange:()=>E("prognosticsCheck")}),label:"Prognostics"}))),r.a.createElement(R.a,{style:{margin:"24px 24px 0px 0px"},id:"outlined-multiline-flexible",multiline:!0,fullWidth:!0,maxRows:20,value:JSON.stringify(x,null,4),InputProps:{readOnly:!0}}))),r.a.createElement(I.a,null,r.a.createElement(m.a,{onClick:u},"Cancel"),r.a.createElement(m.a,{onClick:function(){let e=new Blob([JSON.stringify(x,null,4)],{type:"application/json",name:b+".json"});Object(z.saveAs)(e,b+".json")}},"Save"))))};var F=a(194),W=a(417),V=a(427),Y=a(415),q=r.a.createElement(J.a,null,"Add or Edit Tags");const K=e=>{let{tagNode:t="",tagColors:a={},attrTags:n=[],open:l=!1,handleTagClose:i,updateTag:s,deleteTag:c}=e;const[d,u]=r.a.useState(""),[h,g]=r.a.useState(!1),[f,p]=r.a.useState("#000000");let x={width:"100%",height:"100%",borderRadius:"4px",background:""+f},y={display:n.length>0?"block":"none",margin:"24px 10px 0px 0px"};return r.a.createElement("div",null,r.a.createElement(N.a,{open:l,onClose:i},q,r.a.createElement(j.a,null,r.a.createElement(P.a,null,"You are editing tags for the node: ",r.a.createElement("i",null,t)),r.a.createElement(Y.a,{style:y,direction:"row",spacing:1},n.map((e,t)=>r.a.createElement(V.a,{label:e,variant:"outlined",onDelete:()=>(e=>{c(e)})(e),sx:{color:a[e]}}))),r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement(W.a,{disablePortal:!0,freeSolo:!0,options:Object.keys(a),sx:{margin:"24px 10px 0px 0px",width:"300px"},onChange:(e,t)=>function(e,t){u(t),p(a[t])}(0,t),onInputChange:e=>function(e){u(e.target.value)}(e),renderInput:e=>r.a.createElement(R.a,Object(o.a)({},e,{label:"Tag Name"}))}),r.a.createElement("div",{style:{margin:"24px 24px 0px 0px",width:"48px",height:"48px",padding:"4px",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.1)",display:"inline-block",cursor:"pointer"},onClick:()=>{g(!h)}},r.a.createElement("div",{style:x}),h?r.a.createElement("div",{style:{position:"fixed",zIndex:"1301"}},r.a.createElement("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:()=>{g(!1)}}),r.a.createElement(F.a,{color:f,onChange:e=>{p(e.hex)}})):null))),r.a.createElement(I.a,null,r.a.createElement(m.a,{onClick:i},"Close"),r.a.createElement(m.a,{onClick:()=>{""===d||s(f,d),p("#000000")}},"Add"))))};var U=r.a.createElement(P.a,null,"Add Custom Node");const X=e=>{let{open:t=!1,handleNodeClose:a,addAttribute:n,addCustom:l}=e;const[o,i]=r.a.useState("");return r.a.createElement("div",null,r.a.createElement(N.a,{open:t,onClose:a},r.a.createElement(j.a,null,U,r.a.createElement(R.a,{style:{margin:"24px 24px 0px 0px"},id:"outlined-basic",label:"Variable Name",variant:"outlined",onChange:e=>function(e){i(e.target.value)}(e)})),r.a.createElement(I.a,null,r.a.createElement(m.a,{onClick:a},"Cancel"),r.a.createElement(m.a,{onClick:function(){""===o||(l(o),i("")),a()}},"Add"))))};var Q=a(428),Z=a(431),ee=a(426),te=a(191),ae=a.n(te),ne=a(192),re=a.n(ne),le=a(193),oe=a.n(le),ie=a(190),se=a.n(ie),ce=r.a.createElement(se.a,null),de=r.a.createElement(ae.a,null),ue=r.a.createElement(re.a,null);const me=e=>{let{attributes:t=[],graph:a,_svg:l="svgDAG",_dag:m,_colliders:h,_mediators:g,_confounds:f,_prognostics:p}=e;const[x,y]=r.a.useState({nodes:[],links:[]}),[b,E]=r.a.useState("default"),[C,w]=r.a.useState(!1),[S,O]=r.a.useState(!1),[M,T]=r.a.useState(!1),[N,I]=r.a.useState(),[j,P]=r.a.useState({}),[J,D]=r.a.useState(""),[L,B]=r.a.useState([]),[G,_]=r.a.useState([]),[H,F]=r.a.useState([]),[V,Y]=r.a.useState([]),[q,U]=r.a.useState({}),[te,ae]=r.a.useState([]),[ne,re]=r.a.useState(""),[le,ie]=r.a.useState(""),[se,me]=r.a.useState({}),[he,ge]=r.a.useState(new Set),fe={height:500,width:1e3,margin:60};function pe(){return(new Date).getTime()+Math.floor(98*Math.random())}function xe(e,t,a,n,r){let l=document.getElementById(m),o=JSON.stringify(e),i=document.getElementById(h),s=document.getElementById(g),c=document.getElementById(f),d=document.getElementById(p);var u;l&&(l.value=o,(u=document.createEvent("HTMLEvents")).initEvent("input",!1,!0),l.dispatchEvent(u));i&&(i.value=JSON.stringify(t),(u=document.createEvent("HTMLEvents")).initEvent("input",!1,!0),i.dispatchEvent(u));s&&(s.value=JSON.stringify(a),(u=document.createEvent("HTMLEvents")).initEvent("input",!1,!0),s.dispatchEvent(u));c&&(c.value=JSON.stringify(n),(u=document.createEvent("HTMLEvents")).initEvent("input",!1,!0),c.dispatchEvent(u));d&&(d.value=JSON.stringify(r),(u=document.createEvent("HTMLEvents")).initEvent("input",!1,!0),d.dispatchEvent(u))}function ye(e,t,a,n){if(void 0===t&&(t=!1),void 0===a&&(a=fe.width/2),void 0===n&&(n=fe.height/2),te.indexOf(e)<0){const r=pe(),l={nodes:[...x.nodes,{x:a,y:n,id:r,name:e,parents:new Set,children:new Set,$custom:q[e]?q[e].$custom:t,tags:q[e]?q[e].tags:[]}],links:[...x.links]};y(l),ae([...te,e])}}function be(e){let t=te.indexOf(e);te.splice(t,1),ae([...te]);let a=x.nodes.filter(t=>t.name!==e),n=x.links.filter(t=>t.target.name!==e&&t.source.name!==e);y({nodes:[...a],links:[...n]}),e===ne&&re(""),e===le&&ie("")}function ke(e){re(e)}function Ee(e){ie(e)}Object(n.useEffect)(()=>{if(a){let t=function(e){var t=Object(d.a)().domain(Object(u.a)(e.nodes,e=>e.x)).range([fe.margin,fe.width-fe.margin]),a=Object(d.a)().domain(Object(u.a)(e.nodes,e=>e.y)).range([fe.margin,fe.height-fe.margin]);let n=JSON.parse(JSON.stringify(e)),r=n.nodes,l=n.links,o=new Set,i={};for(let e of r){if(!e.id){let t=pe();for(;o.has(t);)t=pe();e.id=t}o.add(e.id),e.x=t(e.x),e.y=a(e.y),e.children=new Set,e.parents=new Set,i[e.name]={$custom:!1,tags:[]}}ge(o),U(i),ae(Object.keys(i));for(let e of l){let t=e.source.name?e.source.name:e.source,a=e.target.name?e.target.name:e.target,n=r.filter(e=>e.name===t)[0],l=r.filter(e=>e.name===a)[0];n.children.add(l.id),l.parents.add(n.id),e.source={...r.filter(e=>e.name===t)[0]},e.target={...r.filter(e=>e.name===a)[0]},delete e.source.children,delete e.source.parents,delete e.target.children,delete e.target.parents}return n}(a);y(t);let n=document.getElementById(m),r=JSON.stringify(t);if(n){n.value=r;var e=document.createEvent("HTMLEvents");e.initEvent("input",!1,!0),n.dispatchEvent(e)}}},[a]),Object(n.useEffect)(()=>{if(t&&t.length>0&&!a){let e={};for(let a of t)e[a]={$custom:!1,tags:[]};U(e)}},[t]),Object(n.useEffect)(()=>{if(ne.length>0&&le.length>0){let e=Array.from(Se(ne,le)),t=[];for(let a of e)t.push(x.nodes.filter(e=>e.id===a)[0].name);let a=Array.from(Oe(ne,le)),n=Me(ne,le),r=we(ne,le,a.map(e=>e.id),n.map(e=>e.id));B(t),_(a.map(e=>e.name)),F(n.map(e=>e.name)),Y(r.map(e=>e.name)),xe(x,t,a,n,r)}else B([]),_([]),F([]),Y([]),xe(x,[],[],[],[])},[ne,le,x]);function ve(){!function(e,t,a,n,r){var l="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e))),o=document.createElement("canvas"),i=o.getContext("2d");o.width=t,o.height=a;var s=new Image;s.onload=function(){i.clearRect(0,0,t,a),i.drawImage(s,0,0,t,a),o.toBlob((function(e){var t=Math.round(e.length/1024)+" KB";r&&r(e,t)}))},s.src=l}(function(e){e.setAttribute("xlink","http://www.w3.org/1999/xlink");var t=(new XMLSerializer).serializeToString(e);return t=(t=t.replace(/(\w+)?:?xlink=/g,"xmlns:xlink=")).replace(/NS\d+:href/g,"xlink:href")}(Object(c.a)("#"+l).node()),2*fe.width,2*fe.height,0,(function(e,t){Object(z.saveAs)(e,"DAG.png")}))}function Ce(e,t){if(void 0===t&&(t=null),e.id===t)return[];let a=Array.from(e.children);for(let n of e.children){let e=x.nodes.filter(e=>e.id===n)[0];a=a.concat(Ce(e,t))}return a}function we(e,t,a,n){if(void 0===a&&(a=[]),void 0===n&&(n=[]),0===x.nodes.length||0===x.links.length)return[];if(""===e||""===t)return[];let r=x.nodes.filter(t=>t.name===e)[0].id,l=x.nodes.filter(e=>e.name===t)[0].id,o=[];for(let e of x.nodes){if(e.id===r)continue;let t=a.indexOf(e.id)>=0,i=n.indexOf(e.id)>=0,s=e.children.has(l),c=e.children.has(r);!s||c||t||i||o.push(e)}return o}function Se(e,t){if(0===x.nodes.length||0===x.links.length)return[];if(""===e||""===t)return[];let a=x.nodes.filter(t=>t.name===e)[0],n=x.nodes.filter(e=>e.name===t)[0],r=Ce(a,n.id),l=new Set(Ce(n));return new Set([...r].filter(e=>l.has(e)))}function Oe(e,t){if(0===x.nodes.length||0===x.links.length)return[];if(""===e||""===t)return[];let a=x.nodes.filter(t=>t.name===e)[0],n=x.nodes.filter(e=>e.name===t)[0].id,r=function e(t,a){if(t.id===a)return[t];if(t.id!==a&&0===t.children.size)return[];let n=[];for(let r of t.children){let t=e(x.nodes.filter(e=>e.id===r)[0],a);t.length>0&&(n=n.concat(t))}return n.map(e=>[t].concat(e))}(a,n),l=[];for(let e of r){let t=e.filter(e=>e.id!==a.id&&e.id!==n);l=l.concat(t)}return new Set(l)}function Me(e,t){if(0===x.nodes.length||0===x.links.length)return[];if(""===e||""===t)return[];let a=[],n=x.nodes.filter(t=>t.name===e)[0].id;for(let r of x.nodes){let l=new Set(Ce(r,n)),o=new Set(x.nodes.filter(e=>l.has(e.id)).map(e=>e.name));o.has(e)&&o.has(t)&&a.push(r)}return a}Object(i.a)({palette:{grey:{light:s.a[300],main:s.a[500],dark:s.a[700],contrastText:"#fff"}}});let Ae={height:"24px"},Te={height:"48px",borderRadius:"24px",marginLeft:"10px","& .MuiOutlinedInput-input":{height:"12px"},"& .MuiOutlinedInput-root":{padding:"11px"},"& .MuiInputLabel-formControl":{top:"-1px"}};return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(k,{attributes:Object.keys(q),added:te,treatment:ne,outcome:le,addAttribute:ye,deleteAttribute:be,changeTreatment:ke,changeOutcome:Ee,handleAddTag:e=>{I(e),T(!0)},handleNodeOpen:()=>{O(!0)}}),r.a.createElement($,{open:C,nodelinks:x,treatment:ne,outcome:le,confounds:H,colliders:L,mediators:G,prognostics:V,handleClose:()=>{w(!1)}}),r.a.createElement(X,{open:S,handleNodeClose:()=>{O(!1)},addAttribute:ye,addCustom:function(e){let t=JSON.parse(JSON.stringify(q));t[e]={$custom:!0,tags:[]},U(t),ye(e,!0)}}),r.a.createElement(K,{tagNode:N,tagColors:j,attrTags:q[N]?q[N].tags:[],open:M,handleTagClose:()=>{T(!1)},updateTag:function(e,t){if(q[N].tags&&q[N].tags.indexOf(t)>=0)return;let a={...x},n=a.nodes.filter(e=>e.name===N)[0];n.tags?n.tags.push(t):n.tags=[t],y(a);let r=JSON.parse(JSON.stringify(q));r[N].tags.push(t),U(r),j[t]=e,P({...j})},deleteTag:function(e){let t={...x},a=t.nodes.filter(e=>e.name===N)[0],n=a.tags.indexOf(e);a.tags.splice(n,1),y(t);let r=JSON.parse(JSON.stringify(q));n=r[N].tags.indexOf(e),r[N].tags.splice(n,1),U(r)}}),r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",width:"100%",alignItems:"center",marginBottom:"20px"}},r.a.createElement(ee.a,{style:{marginBottom:"0px",height:"48px","& .MuiButtonBase-root":{height:"48px"}},value:b,exclusive:!0,onChange:(e,t)=>function(e,t){E(t)}(0,t),"aria-label":"text alignment"},r.a.createElement(Z.a,{value:"default",alt:"select"},r.a.createElement("a",{style:Ae,title:"select"},ce)),r.a.createElement(Z.a,{value:"path",alt:"edit links"},r.a.createElement("a",{style:Ae,title:"edit links"},r.a.createElement(oe.a,{style:{transform:"rotate(-45deg)"}})))),r.a.createElement(W.a,{disablePortal:!0,id:"combo-box-demo",options:te.concat(Object.keys(j).map(e=>"tag:"+e)),sx:{width:300},onChange:(e,t)=>function(e,t){D(t)}(0,t),renderInput:e=>r.a.createElement(R.a,Object(o.a)({},e,{sx:Te,label:"Search"}))}),r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"none"}},r.a.createElement(v.a,{id:"downloadSVG",onClick:()=>ve()},r.a.createElement("a",{style:Ae,title:"save image"},de)),r.a.createElement(v.a,{onClick:()=>(()=>{let e=Se(ne,le),t=[];for(let a of e)t.push(x.nodes.filter(e=>e.id===a)[0].name);let a=Array.from(Oe(ne,le)),n=Me(ne,le),r=we(ne,le,a.map(e=>e.id),n.map(e=>e.id));B(t),_(a.map(e=>e.name)),F(n.map(e=>e.name)),Y(r.map(e=>e.name)),w(!0)})()},r.a.createElement("a",{style:Ae,title:"download JSON"},ue)))),r.a.createElement(Q.a,{elevation:0,variant:"outlined"},r.a.createElement(A,{layout:fe,nodelinks:x,mode:b,treatment:ne,outcome:le,mediators:G,colliders:L,confounds:H,prognostics:V,search:J,updateNodePos:function(e,t,a){let n={...x};for(let r of n.nodes)if(r.id===e){r.x=t,r.y=a;break}for(let r of n.links)r.source.id===e&&(r.source.x=t,r.source.y=a),r.target.id===e&&(r.target.x=t,r.target.y=a);y(n)},deleteAttribute:be,changeTreatment:ke,changeOutcome:Ee,updateLinks:function(e){for(let t of x.links)if(t.source.id===e[0].id&&t.target.id===e[1].id||t.target.id===e[0].id&&t.source.id===e[1].id)return;if(t=e[0],a=e[1],new Set(Ce(a)).has(t.id)&&(alert("This link cannot be added. The DAG must be acyclic."),1))return;var t,a;for(let t of x.nodes)t.id===e[0].id?t.children.add(e[1].id):t.id===e[1].id&&t.parents.add(e[0].id);let n=JSON.parse(JSON.stringify(e));delete n[0].parents,delete n[0].children,delete n[1].parents,delete n[1].children;const r={nodes:[...x.nodes],links:[...x.links,{source:n[0],target:n[1]}]};y(r)},deleteLinks:function(e){const t=x.links.filter(t=>!(t.source.id===e.source.id&&t.target.id===e.target.id));for(let t of x.nodes)t.id===e.source.id?t.children.delete(e.target.id):t.id===e.target.id&&t.parents.delete(e.source.id);const a={nodes:[...x.nodes],links:[...t]};y(a)},_svg:l}))))};var he=r.a.createElement("h1",null,"Causalvis"),ge=r.a.createElement("p",null,"This is a browser demo of the DAG module of the ",r.a.createElement("a",{href:"https://github.com/causalvis/causalvis"},"Causalvis Python package"),". For more information about this work, please refer to ",r.a.createElement("a",{href:"https://dl.acm.org/doi/full/10.1145/3544548.3581236"},"our paper"),"."),fe=r.a.createElement(me,null),pe=r.a.createElement("h3",null,"Usage"),xe=r.a.createElement("i",null,".json");const ye=()=>r.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",fontFamily:"sans-serif"}},r.a.createElement("div",null,he,ge,fe,pe,r.a.createElement("p",{style:{width:"1200px"}},"The main features of the DAG module are numbered in the image below. 1) The graph can be edited and viewed on the main canvas here. 2) Toggle buttons can be used to switch between node layout editing and link editing. 3) The Add Node button can be used to add nodes to the DAG. 4) The context menu of each variable can be accessed by pressing SHIFT + CLICK on a variable name. This will bring up options to set treatments and outcomes, edit tags, and delete variables from the visualization. 5) The DAG can be downloaded and saved as an image or ",xe," file."),r.a.createElement("img",{style:{width:"1200px"},src:"Figure_DAG.png",alt:"Toggle Modes Button"})));Object(l.render)(r.a.createElement(ye,null),document.querySelector("#app"))}},[[237,1,2]]]);
//# sourceMappingURL=app.a573de90.js.map